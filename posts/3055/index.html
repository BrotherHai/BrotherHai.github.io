<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>看、想、确认：基于知识的视觉推理的视觉和语言模型之间的交互提示 | 海的相思</title><meta name="keywords" content="提示学习"><meta name="author" content="小海"><meta name="copyright" content="小海"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="论文题目：See, Think, Confirm: Interactive Prompting Between Vision and Language Models for Knowledge-based Visual Reasoning  摘要 大型预训练的视觉和语言模型已显示出出色的各种任务能力。然而，解决基于知识的视觉推理任务仍然具有挑战性，这需要一个模型来全面理解图像内容，连接外部世界知">
<meta property="og:type" content="article">
<meta property="og:title" content="看、想、确认：基于知识的视觉推理的视觉和语言模型之间的交互提示">
<meta property="og:url" content="https://brotherhai.github.io/posts/3055/index.html">
<meta property="og:site_name" content="海的相思">
<meta property="og:description" content="论文题目：See, Think, Confirm: Interactive Prompting Between Vision and Language Models for Knowledge-based Visual Reasoning  摘要 大型预训练的视觉和语言模型已显示出出色的各种任务能力。然而，解决基于知识的视觉推理任务仍然具有挑战性，这需要一个模型来全面理解图像内容，连接外部世界知">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.liuxiaohai.ren/20230114221141.png">
<meta property="article:published_time" content="2023-01-14T14:09:17.000Z">
<meta property="article:modified_time" content="2023-01-15T01:25:24.280Z">
<meta property="article:author" content="小海">
<meta property="article:tag" content="提示学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.liuxiaohai.ren/20230114221141.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://brotherhai.github.io/posts/3055/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"6NPNY9RDXE","apiKey":"0bb764dca77fbe684510821caa526895","indexName":"666","hits":{"per_page":6},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '看、想、确认：基于知识的视觉推理的视觉和语言模型之间的交互提示',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-01-15 09:25:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="baidu-site-verification" content="code-eGLQYdBIEA" /><script src="/live2d-widget/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s4.ax1x.com/2021/12/15/ozT0iQ.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/2021/"><i class="fa-fw fas fa-heart"></i><span> 2021</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.liuxiaohai.ren/20230114221141.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">海的相思</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/2021/"><i class="fa-fw fas fa-heart"></i><span> 2021</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">看、想、确认：基于知识的视觉推理的视觉和语言模型之间的交互提示</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-01-14T14:09:17.000Z" title="Created 2023-01-14 22:09:17">2023-01-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-01-15T01:25:24.280Z" title="Updated 2023-01-15 09:25:24">2023-01-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">论文阅读</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="看、想、确认：基于知识的视觉推理的视觉和语言模型之间的交互提示"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>论文题目：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2301.05226">See, Think, Confirm: Interactive Prompting Between Vision and Language Models for Knowledge-based Visual Reasoning</a></p>
</blockquote>
<h1>摘要</h1>
<p>大型预训练的视觉和语言模型已显示出出色的各种任务能力。然而，解决基于知识的<strong>视觉推理</strong>任务仍然具有挑战性，这需要一个模型来全面理解图像内容，连接外部世界知识，并执行分步推理以正确回答问题。为此，我们提出了一种新的框架，称为交互式提示视觉推理器（IPVR），用于基于少数样本的视觉推理。</p>
<p>IPVR包括三个阶段：<strong>看、想和确认</strong>。看阶段扫描图像，并用视觉感知模型为候选视觉概念打下基础。<strong>思考阶段采用预训练的大型语言模型（LLM），以自适应地处理来自候选人的关键概念</strong>。然后，它将它们<strong>转换为文本上下文，以便使用视觉字幕模型进行提示，并采用LLM生成答案。确认阶段进一步使用LLM生成答案的支持理由，使用跨模态分类器验证生成的理由，并确保理由能够一致地推断预测输出</strong>。我们在一系列基于知识的视觉推理数据集上进行了实验。</p>
<p>我们发现我们的IPVR有几个好处：</p>
<ol>
<li>它实现了比前几个样本学习基线更好的性能；</li>
<li>它通过为<strong>每个推理步骤提供理由，享有整个推理过程的完全透明度和可信度；</strong></li>
<li>与其他微调基线相比，它具有计算效率。</li>
</ol>
<h1>绪论</h1>
<p>KBVQA比传统的视觉问答更具挑战性，因为<strong>模型除了感知视觉内容外，还需要了解外部知识</strong>。它有许多现实世界的应用，如聊天机器人、辅助机器人和智能辅导。如<a href="#p1">图1</a>所示，为了回答<font color=YellowGreen>“房间的名称是什么？”</font>这个问题，人类首先需要看到图像并提取视觉概念，如<font color=YellowGreen>“框架”、“沙发”和“灯”</font>。然后，我们关注与该问题语义相关的关键概念，并认为<font color=YellowGreen>“这是一张咖啡桌”和“有一张带棕色枕头的长沙发”可以得到“客厅”的答案</font>。我们最终可以确认答案是正确的，因为<font color=YellowGreen>“沙发和茶几通常位于客厅”</font>。</p>
<div id="p1"></div>
<p><img src="https://cdn.liuxiaohai.ren/20230114222018.png" alt="图1"></p>
<blockquote>
<p>图1。人类处理基于知识的视觉推理的过程。给定一个图像问题对，人类能够看到图像中的所有对象，<strong>思考相关的视觉概念以获得答案，并基于视觉观察和知识最终确认答案是正确的。</strong></p>
</blockquote>
<p>受大型语言模型（LLM）在少样本自然语言处理推理中的成功启发，有几项工作要在视觉和语言任务中采用LLM进行推理。主要方法主要分为两类。</p>
<p><strong>第一类增加了额外的视觉感知模块</strong>，<strong>以将视觉输入转换为LLM的潜在输入</strong>，并<strong>使用大量视觉语言数据微调模型</strong>。尽管这样的流水线可以在下游视觉推理任务上实现高性能，<strong>但它需要一个大型视觉语言数据集来微调LLM和每个下游任务的新视觉模块</strong>，这通常是<strong>计算密集型和耗时的</strong>。</p>
<p><strong>第二类使用基于提示的方法进行视觉推理</strong>。例如，PICa将图像转换为字幕，然后可以将其用作GPT3模型的文本提示输入以回答问题。尽管他们在基于知识的视觉问题回答上具有很高的准确性，但他们的模型有几个局限性。<strong>首先</strong>，PICa中的字幕处理独立于问题的语义，<strong>限制字幕仅关注图像的一般方面</strong>，而不是与问题相关的对象。<strong>第二</strong>，他们不能提供一个逐步的推理跟踪，让问题的回答成为一个<strong>黑箱过程</strong>。</p>
<p>我们想研究的<strong>关键问题</strong>是，我们<strong>如何利用大型视觉和语言模型来实现基于知识的VQA的高精度，同时保持推理过程的透明度和效率。<strong>神经符号推理模型的思想提供了一种有前途的逐步透明的视觉推理方法。他们通常将</strong>输入问题转换成由一系列操作组成的程序，并使用一组网络模块执行这些操作以获得答案</strong>。然而，它们在<strong>性能和透明度方面的成功主要局限于具有简单视觉原始概念的特定领域</strong>（例如，只有三种形状的模拟物理场景）。此外，他们通常需要<strong>为每个操作手动设计和实现符号逻辑，从而限制了他们的应用程序以开放世界为基础的视觉推理。</strong></p>
<p>为了在视觉世界中更有效和可解释的复杂知识推理，我们提出了一个名为<strong>交互式提示视觉推理器（IPVR）<strong>的新框架，以模拟<a href="#p1">图1</a>中的人类推理过程。我们的模型还包含三个关键模块，<strong>一个视觉模块、一个思考模块和一个确认模块。<strong>给定一个图像问题对，<strong>视觉模块首先使用场景解析器来提取图像中的所有候选视觉概念</strong>。<strong>思考模块采用LLM来选择由视觉模块提取的与给定任务相对应的相关视觉概念</strong>（例如，<a href="#p1">图1</a>中的</strong>沙发</strong>），并使用字幕模型将其转换为文本描述（例如，</strong>“有一个带棕色枕头的长沙发”</strong>）。LLM根据关注的视觉环境预测问题的答案（<strong>“客厅”</strong>）。此外，我们引入了一个<strong>用于比率分析验证的确认模块</strong>，以<strong>提供更透明和可信的推理</strong>。具体而言，我们<strong>要求LLM生成理由</strong>（例如，对于<a href="#p1">图1</a>中的预测答案，<strong>“沙发和咖啡桌通常位于客厅”</strong>）。然后，我们用**神经交叉模态分类器估计这些理论和给定视觉输入之间的匹配相似度。**最后，<strong>所选的基本原理被输入到LLM的提示中，以确保基本原理能够一致地推断出相同的输出。<strong>我们重</strong>复思考和反复确认的过程，直到两次后续迭代的答案相同。</strong></p>
<p><strong>总之</strong>，我们介绍了IPVR，这是一种用于基于知识的视觉推理的新型模块化、交互式和迭代框架，它能够<strong>迭代地关注图像中的相关视觉概念</strong>，并为答案预测提供一致的支持依据。IPVR有几个优点。首先，它是有效的。在基于知识的基准测试上进行的大量实验发现，IPVR比之前的几个样本基线实现了更好的性能。此外，<strong>IPVR更加透明和可解释</strong>，因为它保持了导致预测的整个<strong>逐步推理轨迹</strong>。与微调方法相比，IPVR的计算效率也更高。</p>
<h1>相关工作</h1>
<h2 id="提示大型预训练模型">提示大型预训练模型</h2>
<p>像GPT-3这样的大型语言模型已经在自然语言处理（NLP）中普及了少数样本提示，其中几个输入输出对被用作语言模型的上下文，以理解任务并生成新示例的预测。一些提示技术也被开发用于NLP中更有效或透明的推理。后来，这一提示被带到了视觉社区。CLIP和RegionCLIP通过在训练过程中用<strong>自然语言监督代替类标签</strong>，实现零样本分类和检测。UnitedIO使<strong>用语言提示指定每个视觉任务，以执行多任务学习</strong>。不同的是，<strong>我们的目标是使用交互式提示进行基于知识的视觉推理。它需要语言模型和视觉模型之间的频繁交互</strong>，例如提取与任务相关的视觉概念，回忆相应的外部知识，以及验证与视觉上下文一致的文本预测，这在以前没有得到很好的研究。</p>
<h2 id="用于视觉推理的大型预训练模型">用于视觉推理的大型预训练模型</h2>
<p>大型预训练模型也被用于对视觉和语言的推理。大多数工作从海量视觉语言数据中学习大型预训练模型，并针对下游任务对其进行微调，这些<strong>任务通常计算成本极高且耗时</strong>。例如，Flamingo需要在1536 TPUv4上进行15天的微调，图像为1.85亿张，文本为182 GB。还观察到，许多这些预先训练的模型<strong>包含有限的开放世界知识。<strong>与具有外部知识LLM的模型相比，它们在KB-VQA数据集上的性能较差。最近，Y ang等人</strong>将图像转换为文本描述并将其作为LLM的提示，这在基于知识的视觉问题回答上实现了高性能。<strong>然而，其基于文本的视觉上下文独立于查询问题，并</strong>使问题回答过程成为一个黑箱</strong>。</p>
<h2 id="基于知识的视觉推理">基于知识的视觉推理</h2>
<p>我们的工作还与基于知识的视觉问答（KBVQA）相关，这<strong>需要理解图像内容并检索外部知识来回答问题</strong>。大多数早期方法使用深度神经网络来理解图像并从显式知识库中检索相关知识。最近的方法发现，<strong>像GPT-3这样的LLM可以作为知识库，并使用LLM直接回答问题。虽然我们的模型也从LLM中检索相关知识，但它提供了除最终答案预测之外的逐步推理过程。</strong></p>
<h2 id="神经符号视觉推理">神经符号视觉推理</h2>
<p>我们的工作也可以被视为神经模块网络，它提供了<strong>透明的逐步推理</strong>。他们通常将<strong>查询问题分解为一组操作，使用网络模块对每个操作进行建模，并迭代执行这些操作以获得透明的结果</strong>。虽然这些模型更易于解释，但与端到端神经网络方法相比，它们<strong>要么专注于简单的物理场景</strong>，<strong>要么仅在真实世界数据集上实现较差的性能</strong>。<strong>与它们不同的是，我们希望构建一个系统，在保持系统互操作性的同时，能够在开放世界基于知识的视觉推理上实现合理的性能。</strong></p>
<h1>方法</h1>
<h2 id="总览">总览</h2>
<p>在本节中，介绍了一种用于<strong>基于知识的视觉推理的新模型，称为交互式提示视觉推理器（IPVR）</strong>，它可以<strong>理解查询问题，关注图像中的关键视觉概念，检索支持证据，并最终以一步一步的方式获得答案。<strong>IPVR由三个模块组成，即</strong>视觉、思考和确认</strong>，并以迭代方式运行这些模块。如<a href="#p2">图2</a>所示，给定图像及其内容的问题，视觉模块<strong>使用场景解析器检测图像中的所有候选对象（概念）</strong>，并用其<strong>预测的类名表示它们</strong>。它<strong>还为整个图像生成全局描述</strong>。然后，<strong>思考模块使用LLM关注与查询问题语义相关的关键概念，并使用图像字幕以自然语言的形式对其进行描述</strong>。</p>
<div id="p2"></div>
<p><img src="https://cdn.liuxiaohai.ren/20230114223641.png" alt="图2"></p>
<blockquote>
<p>图2:我们IPVR的框架。给定一个图像问题对，我们首先使用<strong>视觉模块检测图像中的所有候选对象</strong>，并将整个<strong>图像转换为全局描述</strong>。然后，<strong>思考模块采用LLM来关注关键的视觉概念，将所选概念转换为带有字幕的语言描述，并利用LLM来预测答案</strong>。<strong>确认模块要求LLM继续生成支持基本原理，验证基本原理是否与图像内容一致，并确保在下一次迭代中将基本原理添加到提示时可以生成相同的答案。</strong></p>
</blockquote>
<p>基于<strong>关注的视觉环境，LLM预测问题的答案。确认模块要求LLM继续生成答案的支持性原理，并使用跨模态分类器对其进行验证</strong>。</p>
<p>为了确保基本原理与答案一致，我们<strong>将已验证的支持基本原理添加回提示上下文中</strong>，并开始新的思考确认迭代。我们<strong>迭代生成答案和基本原理，直到两次后续迭代中的答案预测一致</strong>。我们总结了<a href="#a1">算法1</a>中的整个算法流程。</p>
<div id="a1"></div>
<blockquote>
<p><strong>输入:</strong> 图片和问题 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo separator="true">,</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">{I, Q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span></span></span></span></span>.</p>
<p><strong>输出:</strong> 答案和理由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msup><mi>a</mi><mo>∗</mo></msup><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{a^∗, R\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span></p>
<p><strong>要求：</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">c_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是图像中检测到的第n个概念；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mtext>和</mtext><mi>c</mi><mi>a</mi><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i和cap_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是第i次迭代的概念和区域字幕；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><msub><mi>p</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">cap_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>表示全局图像的字幕。mIter：最大迭代次数；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>t</mi><mi>h</mi><mi>k</mi></mrow></msub><mtext>和</mtext><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{thk}和P_{con}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">hk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是概念选择和问题回答的提示文本。</p>
<p>1: <font color=YellowGreen><strong>#视觉模块</strong></font></p>
<p>2: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>c</mi><mi>n</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>←</mo><mi>I</mi><mi>m</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>P</mi><mi>a</mi><mi>r</mi><mi>s</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\{c_n\}^N_{n=1}←ImageParser(I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">ma</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">rser</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></p>
<p>3: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><msub><mi>p</mi><mi>g</mi></msub><mo>←</mo><mi>G</mi><mi>l</mi><mi>o</mi><mi>b</mi><mi>a</mi><mi>l</mi><mi>C</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cap_g ← GlobalCaptioner(I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Gl</span><span class="mord mathnormal">o</span><span class="mord mathnormal">ba</span><span class="mord mathnormal" style="margin-right:0.07153em;">lC</span><span class="mord mathnormal">a</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></p>
<p>4: i 从0开始. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">a_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是空字符串; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{con,0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 是问题、答案和理由的上下文示例; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>t</mi><mi>h</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{thk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">hk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是问题和对象选择的上下文示例.</p>
<p>5: <strong>repeat：</strong></p>
<p>6: 　 i = i + 1  </p>
<p>7: 　<font color=YellowGreen><strong>#思考模块</strong></font> </p>
<p>8: 　<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>←</mo><mi>L</mi><mi>L</mi><mi>M</mi><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mo stretchy="false">{</mo><msub><mi>c</mi><mi>n</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo separator="true">,</mo><mi>Q</mi><mo separator="true">,</mo><msub><mi>P</mi><mrow><mi>t</mi><mi>h</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_i←LLMAttend(\{c_n\}^N_{n=1}, Q, P_{thk})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">({</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">hk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> </p>
<p>9: 　<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><msub><mi>p</mi><mi>i</mi></msub><mo>←</mo><mi>C</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">cap_i ← Captioner(c_i, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">a</span><span class="mord mathnormal">pt</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span> </p>
<p>10: 　<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_{con,i} = P_{con,i−1} + cap_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> </p>
<p>11: 　<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>←</mo><mi>L</mi><mi>L</mi><mi>M</mi><mi>P</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_i ← LLMPredict (P_{con,i}, Q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.13889em;">MP</span><span class="mord mathnormal">re</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span></span> </p>
<p>12: 　<font color=YellowGreen><strong>#确认模块</strong></font> </p>
<p>13: 　<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>←</mo><mi>L</mi><mi>L</mi><mi>M</mi><mi>C</mi><mi>o</mi><mi>n</mi><mi>f</mi><mi>i</mi><mi>r</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo separator="true">,</mo><mi>Q</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r_i ← LLMConfirm (P_{con,i}, Q, a_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.07153em;">MC</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> </p>
<p>14: 　 <strong>if</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>y</mi><mo stretchy="false">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>t</mi><mi>h</mi><mi>r</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Verify(r_i, I) &gt; thre</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal">re</span></span></span></span> <strong>then</strong> </p>
<p>15: 　　<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo>+</mo><mi>r</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">P_{con,i} = P_{con,i} + ri</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span></span></span></span>  </p>
<p>16: 　<strong>end if</strong></p>
<p>17: <strong>until</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mo>=</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext> </mtext><mi>o</mi><mi>r</mi><mtext> </mtext><mi>i</mi><mo>=</mo><mo>=</mo><mi>m</mi><mi>I</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">a_i == a_{i−1}\ or\ i == mIter</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8679em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace"> </span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span></span></span></span></p>
<p>18: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mo>∗</mo></msup><mo>←</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">;</mo><mi>R</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">{</mo><msub><mi>c</mi><mi>j</mi></msub><mo separator="true">,</mo><mi>c</mi><mi>a</mi><msub><mi>p</mi><mi>j</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^∗ ← a_i ; R = (\{c_j, cap_j\}^i_{j=1}, r_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2194em;vertical-align:-0.3948em;"></span><span class="mopen">({</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>19: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mo stretchy="false">{</mo><msup><mi>a</mi><mo>∗</mo></msup><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">return \{a^∗, R\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">n</span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span></p>
</blockquote>
<p>与现有的上下文学习方法相比，我们的框架具有两个优势，<strong>即有效性和可解释性</strong>。它是有效的，因为它可以自适应地关注相关的视觉区域，并输出一致的答案基本原理预测。它是可解释的，因为它能够对整个推理过程进行逐步调查。这种逐步推理过程的可视化示例见<a href="#p4">图4</a>。</p>
<h2 id="模型详细信息">模型详细信息</h2>
<h3 id="视觉模块">视觉模块</h3>
<p>给定查询图像，我们使用FasterRCNN来检测图像中的所有候选对象。具体而言，我们使用Y ang等人发布的检测模型来<strong>预测对象位置及其分类标签</strong>，如<font color=YellowGreen>“刀”、“盘子”和“餐巾”</font>。它还<strong>使用图像字幕为整个图像提供全局字幕</strong>。这些<strong>视觉概念将在思考模块中进行选择和进一步描述，以提供有价值的视觉上下文来获得答案。</strong></p>
<h3 id="思考模块">思考模块</h3>
<p>我们框架的第二个模块是思考模块，它关注图像中的相应区域，并将它们转换为LLM预测答案的文本描述。为了实现这一目标，我们在思考模块中使用了参与-描述-预测方法，如<a href="#p2">图2(B)</a>所示。<br>
<strong>第一步</strong>是关注，我们使用<strong>提示方法</strong>帮助LLM<strong>关注图像中与查询问题语义相关的关键概念</strong>。<br>
我们在<a href="#p3">图3(A)</a>中展示了<strong>LLM关注关键视觉概念的提示模板</strong>。我们<strong>将训练集中的一些输入输出对输入到LLM的提示中，并要求LLM根据给定的上下文进行选择。</strong></p>
<p><strong>具体来说</strong>问题显示在模板的顶部。在<strong>视觉模块中检测到的对象由其类别名称表示</strong>，例如<font color=YellowGreen>“knife&quot;和&quot;beans”</font>，<strong>LLM输出单词的词汇表被限制为这些类别名称。LLM选择最相关的对象以提供进一步的视觉上下文来处理查询问题。</strong></p>
<p>如<a href="#p2">图2(B)</a>所示，这些关注的概念<font color=YellowGreen>（如“肉”和“刀”）</font>对于回答<font color=YellowGreen>“刀用于哪种食物？”</font>的问题<font color=YellowGreen>“肉”</font>很重要。</p>
<p>思考模块的<strong>下一步是描述</strong>。<strong>裁剪图像中与所选概念相对应的区域，并将其馈送到图像字幕器</strong>，以<strong>生成新概念的区域描述</strong>。<strong>生成的区域描述将添加到LLM的提示中</strong>，以提供细粒度的视觉上下文来预测答案。注意，<strong>对象的区域描述通常比对象类更具信息性</strong>。例如，<a href="#p2">图2</a>中<font color=YellowGreen>“盘子里的一些肉”</font>的标题另外描述了<font color=YellowGreen>“肉”和“盘子”</font>之间的关系。</p>
<p>思考模块的<strong>最后一步是预测</strong>。我们**将训练集中的多个问题回答示例添加到LLM的提示中，并要求其预测问题的答案。**答案预测基于先前迭代中确认模块预测的关注视觉上下文和基本原理，我们将在确认模块中讨论。</p>
<h3 id="确认模块">确认模块</h3>
<p>我们框架的<strong>最后一个模块是确认模块</strong>，如<a href="#p2">图2©</a>所示，其<strong>目的是为答案预测生成一致的支持原理，并验证预测的正确性。<strong>考虑到思考模块生成的少量示例上下文和交互式提示，我们要求</strong>LLM在预测答案后继续预测支持性原理。</strong><a href="#p3">图3(B)</a>所示，**可以找到此类问答基本原理模板的快速示例。**LLM预测的一个重要问题是，<strong>生成过程是一个黑箱，很难验证预测答案和原理的正确性。<strong>我们认为，正确的理由应该有两个不同的特点。<strong>首先，基本原理应与答案一致。<strong>考虑到答案（<font color=YellowGreen>“肉”</font>）的预测支持理由（<a href="#p2">图2</a>中的<font color=YellowGreen>“刀是用来切肉的”</font>），我们</strong>应该能够在将其添加到上下文中时预测相同的答案。其次，基本原理应与视觉输入一致。</strong><br>
为了确保基本原理支持答案预测，我们在</strong>下一次迭代中将生成的文本基本原理输入到LLM的提示中。我们重复这个回答基本原理和回答基本原理过程，直到两个随后的预测答案相同</strong>（<a href="#a1">算法1</a>的第4行至第17行）。为了确保生成的基本原理与给定的视觉上下文一致，<strong>我们使用大型预训练的跨模态分类器来验证文本基本原理是否与给定图像匹配</strong>（<a href="#a1">算法1</a>的第13行至第15行）。<strong>只有具有高匹配相似度的基本原理才会被接受，并添加到下一次迭代中的答案预测提示中。</strong></p>
<div id="p3"></div>
<p><img src="https://cdn.liuxiaohai.ren/20230114231847.png" alt="图3"></p>
<blockquote>
<p>图3。图3（A）-（B）中的视觉概念注意提示模板和完整问答推理示例。上下文示例和测试示例中的输出用<font color=Blue>蓝色</font>和<font color=Green>绿色</font>标记。前几次迭代中的注意区域说明和基本原理用<font color=Red>红色</font>和<font color=#cd7f32>青铜色</font>标记。我们将上下文示例中<strong>最相关的选项视为通过CLIP相似性最接近地面真相答案的选项（概念）</strong>。</p>
</blockquote>
<div id="p4"></div>
<p><img src="https://cdn.liuxiaohai.ren/20230114230830.png" alt="图4"></p>
<blockquote>
<p>图4.IPVR和基线的定性结果。除了更好的答案准确性外，我们的方法还通过提供相关视觉概念、区域描述和支持性原理的逐步推理跟踪，获得了更好的透明度。→ 表示我们的推理流程。</p>
</blockquote>
<h1>实验</h1>
<h2 id="实施细节">实施细节</h2>
<p>所提出的IPVR的有效性<strong>依赖于几个预先训练的视觉模型和语言模型</strong>的相互作用。我们选择了Han等人发布的更快的<strong>R-CNN模型</strong>来检测图像中的<strong>视觉概念</strong>，该模型在视觉基因组上进行了1595个不同类别的训练。我们选择<strong>BLIP作为关注对象的区域字幕模型</strong>。我们从图像中裁剪对象候选，并将其边界框扩展1.5倍，<strong>为字幕提供额外的视觉上下文</strong>。为了使区域字幕更符合问题，我们使用<strong>约束解码（constrained decoding）生成区域字幕</strong>。我们在补充材料中提供了更多实施细节。我们使用<strong>OPT-66B作为大型预训练语言模型进行提示</strong>，因为它是有效的、公开可用的，并且易于使用6个NVIDIA V100 PCIe 32 GB运行。我们使用<strong>CLIP模型（ViT-B/16）验证了原理和图像之间的匹配相似性</strong>。</p>
<p>第3.2节的思考模块需要上下文示例来告知LLM进行预测的任务。我们将<strong>上下文中示例的数量固定为8</strong>，因为这是我们可以在硬件配置上高效运行的最大数量。继Yang等人之后，我们<strong>通过上下文中的示例选择和多查询集成来提示LLM。<strong>对于上下文中的示例，我们</strong>选择与训练集中当前图像问题对最相似的示例</strong>及其CLIP特征。对于多查询集成，我们将模型和基线馈送5次，并选择对数概率最高的一个作为之前的方法，除了<a href="#t3">表3</a>中的对齐基线模型，其中我们将基线集成14次，以使其具有与我们的模型相似的计算成本。</p>
<div id="t3"></div>
<p><img src="https://cdn.liuxiaohai.ren/20230115092350.png" alt="表3"></p>
<blockquote>
<p>表3。A-OKVQA验证集和OK-VQA集的计算成本分析。在考虑计算成本问题后，我们的方法仍然优于PICa和CoT。</p>
</blockquote>
<h1>Conclusion</h1>
<p>在本文中，我们开发了一个新的基于知识的视觉推理模型，称为交互式提示视觉推理器（IPVR），该模型要求模型同时理解图像内容和外部知识，以回答查询问题。IPVR可以自适应地关注图像中的相关视觉概念，将其转换为自然语言，并提供一致的推理来支持答案预测。与现有的提示方法相比，它不仅实现了更好的性能，而且通过保持每个推理步骤的完整轨迹，保持了高透明度。我们希望我们的IPVR能够激发未来对不同模式的预训练模型之间的交互提示的更多研究，以构建更有效和可解释的视觉常识推理系统。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">小海</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://brotherhai.github.io/posts/3055/">https://brotherhai.github.io/posts/3055/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%8F%90%E7%A4%BA%E5%AD%A6%E4%B9%A0/">提示学习</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.liuxiaohai.ren/20230114221141.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/25302/"><img class="prev-cover" src="https://cdn.liuxiaohai.ren/20230216223533.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">用于图像分类的深子域自适应网络</div></div></a></div><div class="next-post pull-right"><a href="/posts/29529/"><img class="next-cover" src="https://s4.ax1x.com/2021/12/14/oxfL7j.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">基于属性描述的零样本滚动轴承故障诊断</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/5746/" title="通过提示学习进行领域适应"><img class="cover" src="https://cdn.liuxiaohai.ren/20230111171517.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-11</div><div class="title">通过提示学习进行领域适应</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s4.ax1x.com/2021/12/15/ozT0iQ.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">小海</div><div class="author-info__description">辽远的海的相思</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/BrotherHai"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">摘要</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">绪论</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">相关工作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E7%A4%BA%E5%A4%A7%E5%9E%8B%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.1.</span> <span class="toc-text">提示大型预训练模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E4%BA%8E%E8%A7%86%E8%A7%89%E6%8E%A8%E7%90%86%E7%9A%84%E5%A4%A7%E5%9E%8B%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.2.</span> <span class="toc-text">用于视觉推理的大型预训练模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E7%9F%A5%E8%AF%86%E7%9A%84%E8%A7%86%E8%A7%89%E6%8E%A8%E7%90%86"><span class="toc-number">3.3.</span> <span class="toc-text">基于知识的视觉推理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A5%9E%E7%BB%8F%E7%AC%A6%E5%8F%B7%E8%A7%86%E8%A7%89%E6%8E%A8%E7%90%86"><span class="toc-number">3.4.</span> <span class="toc-text">神经符号视觉推理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E8%A7%88"><span class="toc-number">4.1.</span> <span class="toc-text">总览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-number">4.2.</span> <span class="toc-text">模型详细信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E8%A7%89%E6%A8%A1%E5%9D%97"><span class="toc-number">4.2.1.</span> <span class="toc-text">视觉模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%80%83%E6%A8%A1%E5%9D%97"><span class="toc-number">4.2.2.</span> <span class="toc-text">思考模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E8%AE%A4%E6%A8%A1%E5%9D%97"><span class="toc-number">4.2.3.</span> <span class="toc-text">确认模块</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%96%BD%E7%BB%86%E8%8A%82"><span class="toc-number">5.1.</span> <span class="toc-text">实施细节</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/47691/" title="24岁生日回顾"><img src="https://s4.ax1x.com/2021/12/14/oxfL7j.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="24岁生日回顾"/></a><div class="content"><a class="title" href="/posts/47691/" title="24岁生日回顾">24岁生日回顾</a><time datetime="2023-10-19T13:31:22.000Z" title="Created 2023-10-19 21:31:22">2023-10-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/52035/" title="用于预测和健康管理的类似ChatGPT的大规模基础模型：调查和路线图"><img src="https://cdn.liuxiaohai.ren/20230516211434.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用于预测和健康管理的类似ChatGPT的大规模基础模型：调查和路线图"/></a><div class="content"><a class="title" href="/posts/52035/" title="用于预测和健康管理的类似ChatGPT的大规模基础模型：调查和路线图">用于预测和健康管理的类似ChatGPT的大规模基础模型：调查和路线图</a><time datetime="2023-05-16T11:27:00.000Z" title="Created 2023-05-16 19:27:00">2023-05-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/15662/" title="无监督域共享CNN用于从稳定速度到时变速度的机器故障转移诊断"><img src="https://s4.ax1x.com/2021/12/14/oxfL7j.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无监督域共享CNN用于从稳定速度到时变速度的机器故障转移诊断"/></a><div class="content"><a class="title" href="/posts/15662/" title="无监督域共享CNN用于从稳定速度到时变速度的机器故障转移诊断">无监督域共享CNN用于从稳定速度到时变速度的机器故障转移诊断</a><time datetime="2023-05-13T07:08:54.000Z" title="Created 2023-05-13 15:08:54">2023-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/51274/" title="河大一季度"><img src="https://cdn.liuxiaohai.ren/d3093a3c482d03895865389a1c24238.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="河大一季度"/></a><div class="content"><a class="title" href="/posts/51274/" title="河大一季度">河大一季度</a><time datetime="2023-05-12T11:47:04.000Z" title="Created 2023-05-12 19:47:04">2023-05-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/16234/" title="自监督学习食谱"><img src="https://s4.ax1x.com/2021/12/14/oxfL7j.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="自监督学习食谱"/></a><div class="content"><a class="title" href="/posts/16234/" title="自监督学习食谱">自监督学习食谱</a><time datetime="2023-04-26T06:39:39.000Z" title="Created 2023-04-26 14:39:39">2023-04-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 小海</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Algolia</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script>window.$crisp = [];
window.CRISP_WEBSITE_ID = "2805294f-b0a7-4aef-a341-71156c7845d4";
(function () {
  d = document;
  s = d.createElement("script");
  s.src = "https://client.crisp.chat/l.js";
  s.async = 1;
  d.getElementsByTagName("head")[0].appendChild(s);
})();
$crisp.push(["safe", true])

if (true) {
  $crisp.push(["do", "chat:hide"])
  $crisp.push(["on", "chat:closed", function() {
    $crisp.push(["do", "chat:hide"])
  }])
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      $crisp.push(["do", "chat:show"])
      $crisp.push(["do", "chat:open"])

    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      $crisp.push(["do", "chat:hide"])
    }
    function chatBtnShow () {
      $crisp.push(["do", "chat:show"])
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>